{% extends 'products/base.html' %}

{% block title %}Shopping Cart - Harry Dickerson{% endblock %}

{% block content %}

<h1 style="letter-spacing: 3px; margin-bottom: 30px;">SHOPPING CART</h1>

{% if cart %}
    <div style="background: #fff; padding: 30px;">
        
        <!-- CART ITEMS TABLE -->
        <table style="width: 100%; border-collapse: collapse;">
            <thead>
                <tr style="border-bottom: 2px solid #000;">
                    <th style="text-align: left; padding: 15px 10px; letter-spacing: 1px;">PRODUCT</th>
                    <th style="text-align: center; padding: 15px 10px; letter-spacing: 1px;">PRICE</th>
                    <th style="text-align: center; padding: 15px 10px; letter-spacing: 1px;">QUANTITY</th>
                    <th style="text-align: center; padding: 15px 10px; letter-spacing: 1px;">TOTAL</th>
                    <th style="text-align: center; padding: 15px 10px; letter-spacing: 1px;">REMOVE</th>
                </tr>
            </thead>
            <tbody>
                {% for item in cart %}
                <tr style="border-bottom: 1px solid #eee;">
                    <td style="padding: 20px 10px;">
                        <div style="display: flex; align-items: center; gap: 15px;">
                            {% if item.product.image %}
                                <img src="{{ item.product.image.url }}" alt="{{ item.product.name }}"
                                     style="width: 80px; height: 80px; object-fit: cover;">
                            {% else %}
                                <div style="width: 80px; height: 80px; background: #eee;"></div>
                            {% endif %}
                            <div>
                                <a href="{% url 'products:product_detail' item.product.pk %}"
                                   style="color: #000; text-decoration: none; font-weight: bold;">
                                    {{ item.product.name }}
                                </a>
                            </div>
                        </div>
                    </td>
                    <td style="text-align: center; padding: 20px 10px;">£{{ item.price }}</td>
                    <td style="text-align: center; padding: 20px 10px;">
                        <form method="post" action="{% url 'cart:cart_update' item.product.id %}" 
                              style="display: inline-flex; align-items: center; gap: 10px;">
                            {% csrf_token %}
                            <input type="number" name="quantity" value="{{ item.quantity }}" 
                                   min="1" max="{{ item.product.stock }}"
                                   style="width: 60px; padding: 5px; text-align: center; border: 1px solid #ccc;">
                            <button type="submit" style="padding: 5px 10px; background: #000; color: #fff; 
                                                          border: none; cursor: pointer; font-size: 0.8rem;">
                                UPDATE
                            </button>
                        </form>
                    </td>
                    <td style="text-align: center; padding: 20px 10px; font-weight: bold;">
                        £{{ item.total_price }}
                    </td>
                    <td style="text-align: center; padding: 20px 10px;">
                        <form method="post" action="{% url 'cart:cart_remove' item.product.id %}">
                            {% csrf_token %}
                            <button type="submit" style="background: none; border: none; color: red; 
                                                          cursor: pointer; font-size: 1.2rem;">
                                ✕
                            </button>
                        </form>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        <!-- CART TOTALS -->
        <div style="margin-top: 40px; text-align: right;">
            <p style="font-size: 1.2rem; margin-bottom: 10px;">
                Total Items: <strong>{{ cart|length }}</strong>
            </p>
            <p style="font-size: 1.5rem; margin-bottom: 30px;">
                Total: <strong>£{{ cart.get_total_price }}</strong>
            </p>
            
            <div style="display: flex; gap: 15px; justify-content: flex-end;">
                <a href="{% url 'products:product_list' %}" class="btn-outline btn">Continue Shopping</a>
                <a href="#" class="btn">Proceed to Checkout</a>
            </div>
        </div>
    </div>

{% else %}
    <div style="background: #fff; padding: 60px; text-align: center;">
        <p style="font-size: 1.2rem; color: #666; margin-bottom: 30px;">Your cart is empty.</p>
        <a href="{% url 'products:product_list' %}" class="btn">Start Shopping</a>
    </div>
{% endif %}

{% endblock %}